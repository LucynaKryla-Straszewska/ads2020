<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Outliers | Week 5 - Skepticism, optimisim and critiquing data analyses</title>
  <meta name="description" content="This book provides course material for Biostatistics 140.711 at the Johns Hopkins Bloomberg School of Public Health." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Outliers | Week 5 - Skepticism, optimisim and critiquing data analyses" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides course material for Biostatistics 140.711 at the Johns Hopkins Bloomberg School of Public Health." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Outliers | Week 5 - Skepticism, optimisim and critiquing data analyses" />
  
  <meta name="twitter:description" content="This book provides course material for Biostatistics 140.711 at the Johns Hopkins Bloomberg School of Public Health." />
  

<meta name="author" content="Jeff Leek and Roger D. Peng" />


<meta name="date" content="2020-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-5.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<img src ="ads2020-small.png" class="center">

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome and Syllabus</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#assumptions-and-pre-requisites"><i class="fa fa-check"></i><b>1.1</b> Assumptions and pre-requisites</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#course-staff"><i class="fa fa-check"></i><b>1.3</b> Course Staff</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-logistics"><i class="fa fa-check"></i><b>1.4</b> Course logistics</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#assignment-due-dates"><i class="fa fa-check"></i><b>1.5</b> Assignment Due Dates</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#the-pandemic"><i class="fa fa-check"></i><b>1.6</b> The Pandemic</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#grading"><i class="fa fa-check"></i><b>1.7</b> Grading</a><ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#philosophy"><i class="fa fa-check"></i><b>1.7.1</b> Philosophy</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#relative-weights"><i class="fa fa-check"></i><b>1.7.2</b> Relative weights</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#assignments"><i class="fa fa-check"></i><b>1.8</b> Assignments</a><ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#submitting-assignments"><i class="fa fa-check"></i><b>1.8.1</b> Submitting assignments</a></li>
<li class="chapter" data-level="1.8.2" data-path="index.html"><a href="index.html#data-analysis-assignments"><i class="fa fa-check"></i><b>1.8.2</b> Data Analysis Assignments</a></li>
<li class="chapter" data-level="1.8.3" data-path="index.html"><a href="index.html#data-analysis-reviews"><i class="fa fa-check"></i><b>1.8.3</b> Data Analysis Reviews</a></li>
<li class="chapter" data-level="1.8.4" data-path="index.html"><a href="index.html#reviewing-code-of-conduct"><i class="fa fa-check"></i><b>1.8.4</b> Reviewing Code of Conduct</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>1.9</b> Code of Conduct</a><ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#need-help"><i class="fa fa-check"></i><b>1.9.1</b> Need Help?</a></li>
<li class="chapter" data-level="1.9.2" data-path="index.html"><a href="index.html#feedback"><i class="fa fa-check"></i><b>1.9.2</b> Feedback</a></li>
<li class="chapter" data-level="1.9.3" data-path="index.html"><a href="index.html#license-and-attribution"><i class="fa fa-check"></i><b>1.9.3</b> License and attribution</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#academic-ethics"><i class="fa fa-check"></i><b>1.10</b> Academic Ethics</a></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#disability-support-services"><i class="fa fa-check"></i><b>1.11</b> Disability support services</a></li>
<li class="chapter" data-level="1.12" data-path="index.html"><a href="index.html#email-alerts"><i class="fa fa-check"></i><b>1.12</b> Email alerts</a></li>
<li class="chapter" data-level="1.13" data-path="index.html"><a href="index.html#previous-versions-of-the-class"><i class="fa fa-check"></i><b>1.13</b> Previous versions of the class</a></li>
<li class="chapter" data-level="1.14" data-path="index.html"><a href="index.html#typos-and-corrections"><i class="fa fa-check"></i><b>1.14</b> Typos and corrections</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-1.html"><a href="week-1.html"><i class="fa fa-check"></i><b>2</b> Week 1</a><ul>
<li class="chapter" data-level="2.1" data-path="week-1.html"><a href="week-1.html#week-1-learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Week 1 Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="week-1.html"><a href="week-1.html#what-is-advanced-data-science-anyway"><i class="fa fa-check"></i><b>2.2</b> What is advanced data science anyway?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="week-1.html"><a href="week-1.html#maybe-we-should-start-by-defining-data-science."><i class="fa fa-check"></i><b>2.2.1</b> Maybe we should start by defining data science….</a></li>
<li class="chapter" data-level="2.2.2" data-path="week-1.html"><a href="week-1.html#data-science-is-hard-but-not-like-math-is-hard"><i class="fa fa-check"></i><b>2.2.2</b> Data Science is hard, but not like math is hard</a></li>
<li class="chapter" data-level="2.2.3" data-path="week-1.html"><a href="week-1.html#so-what-is-advanced-data-science"><i class="fa fa-check"></i><b>2.2.3</b> So what is advanced data science?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="week-1.html"><a href="week-1.html#types-of-data-analytic-questions"><i class="fa fa-check"></i><b>2.3</b> Types of data analytic questions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="week-1.html"><a href="week-1.html#descriptive"><i class="fa fa-check"></i><b>2.3.1</b> Descriptive</a></li>
<li class="chapter" data-level="2.3.2" data-path="week-1.html"><a href="week-1.html#exploratory"><i class="fa fa-check"></i><b>2.3.2</b> Exploratory</a></li>
<li class="chapter" data-level="2.3.3" data-path="week-1.html"><a href="week-1.html#inferential"><i class="fa fa-check"></i><b>2.3.3</b> Inferential</a></li>
<li class="chapter" data-level="2.3.4" data-path="week-1.html"><a href="week-1.html#predictive"><i class="fa fa-check"></i><b>2.3.4</b> Predictive</a></li>
<li class="chapter" data-level="2.3.5" data-path="week-1.html"><a href="week-1.html#causal"><i class="fa fa-check"></i><b>2.3.5</b> Causal</a></li>
<li class="chapter" data-level="2.3.6" data-path="week-1.html"><a href="week-1.html#mechanistic"><i class="fa fa-check"></i><b>2.3.6</b> Mechanistic</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="week-1.html"><a href="week-1.html#a-data-analytic-rubric"><i class="fa fa-check"></i><b>2.4</b> A data analytic rubric</a><ul>
<li class="chapter" data-level="2.4.1" data-path="week-1.html"><a href="week-1.html#answering-the-question"><i class="fa fa-check"></i><b>2.4.1</b> Answering the question</a></li>
<li class="chapter" data-level="2.4.2" data-path="week-1.html"><a href="week-1.html#checking-the-data"><i class="fa fa-check"></i><b>2.4.2</b> Checking the data</a></li>
<li class="chapter" data-level="2.4.3" data-path="week-1.html"><a href="week-1.html#tidying-the-data"><i class="fa fa-check"></i><b>2.4.3</b> Tidying the data</a></li>
<li class="chapter" data-level="2.4.4" data-path="week-1.html"><a href="week-1.html#exploratory-analysis"><i class="fa fa-check"></i><b>2.4.4</b> Exploratory analysis</a></li>
<li class="chapter" data-level="2.4.5" data-path="week-1.html"><a href="week-1.html#inference"><i class="fa fa-check"></i><b>2.4.5</b> Inference</a></li>
<li class="chapter" data-level="2.4.6" data-path="week-1.html"><a href="week-1.html#prediction"><i class="fa fa-check"></i><b>2.4.6</b> Prediction</a></li>
<li class="chapter" data-level="2.4.7" data-path="week-1.html"><a href="week-1.html#causality"><i class="fa fa-check"></i><b>2.4.7</b> Causality</a></li>
<li class="chapter" data-level="2.4.8" data-path="week-1.html"><a href="week-1.html#written-analyses"><i class="fa fa-check"></i><b>2.4.8</b> Written analyses</a></li>
<li class="chapter" data-level="2.4.9" data-path="week-1.html"><a href="week-1.html#figures"><i class="fa fa-check"></i><b>2.4.9</b> Figures</a></li>
<li class="chapter" data-level="2.4.10" data-path="week-1.html"><a href="week-1.html#presentations"><i class="fa fa-check"></i><b>2.4.10</b> Presentations</a></li>
<li class="chapter" data-level="2.4.11" data-path="week-1.html"><a href="week-1.html#reproducibility"><i class="fa fa-check"></i><b>2.4.11</b> Reproducibility</a></li>
<li class="chapter" data-level="2.4.12" data-path="week-1.html"><a href="week-1.html#r-packages"><i class="fa fa-check"></i><b>2.4.12</b> R packages</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="week-1.html"><a href="week-1.html#your-first-assignment---deconstructing-an-analysis"><i class="fa fa-check"></i><b>2.5</b> Your first assignment - deconstructing an analysis</a></li>
<li class="chapter" data-level="2.6" data-path="week-1.html"><a href="week-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional Resources</a></li>
<li class="chapter" data-level="2.7" data-path="week-1.html"><a href="week-1.html#homework"><i class="fa fa-check"></i><b>2.7</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-2.html"><a href="week-2.html"><i class="fa fa-check"></i><b>3</b> Week 2</a><ul>
<li class="chapter" data-level="3.1" data-path="week-2.html"><a href="week-2.html#week-2-learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Week 2 Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="week-2.html"><a href="week-2.html#the-steps-in-a-data-analysis"><i class="fa fa-check"></i><b>3.2</b> The steps in a data analysis</a><ul>
<li class="chapter" data-level="3.2.1" data-path="week-2.html"><a href="week-2.html#defining-the-question"><i class="fa fa-check"></i><b>3.2.1</b> Defining the question</a></li>
<li class="chapter" data-level="3.2.2" data-path="week-2.html"><a href="week-2.html#defining-the-ideal-data-set"><i class="fa fa-check"></i><b>3.2.2</b> Defining the ideal data set</a></li>
<li class="chapter" data-level="3.2.3" data-path="week-2.html"><a href="week-2.html#determine-the-data-you-can-access"><i class="fa fa-check"></i><b>3.2.3</b> Determine the data you can access</a></li>
<li class="chapter" data-level="3.2.4" data-path="week-2.html"><a href="week-2.html#obtain-the-data"><i class="fa fa-check"></i><b>3.2.4</b> Obtain the data</a></li>
<li class="chapter" data-level="3.2.5" data-path="week-2.html"><a href="week-2.html#clean-the-data"><i class="fa fa-check"></i><b>3.2.5</b> Clean the data</a></li>
<li class="chapter" data-level="3.2.6" data-path="week-2.html"><a href="week-2.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>3.2.6</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="3.2.7" data-path="week-2.html"><a href="week-2.html#statistical-predictionmodeling"><i class="fa fa-check"></i><b>3.2.7</b> Statistical prediction/modeling</a></li>
<li class="chapter" data-level="3.2.8" data-path="week-2.html"><a href="week-2.html#interpret-results"><i class="fa fa-check"></i><b>3.2.8</b> Interpret results</a></li>
<li class="chapter" data-level="3.2.9" data-path="week-2.html"><a href="week-2.html#challenge-results"><i class="fa fa-check"></i><b>3.2.9</b> Challenge results</a></li>
<li class="chapter" data-level="3.2.10" data-path="week-2.html"><a href="week-2.html#synthesizewrite-up-results"><i class="fa fa-check"></i><b>3.2.10</b> Synthesize/write up results</a></li>
<li class="chapter" data-level="3.2.11" data-path="week-2.html"><a href="week-2.html#create-reproducible-code"><i class="fa fa-check"></i><b>3.2.11</b> Create reproducible code</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="week-2.html"><a href="week-2.html#raw-informal-and-formal-data-science"><i class="fa fa-check"></i><b>3.3</b> Raw, informal, and formal data science</a></li>
<li class="chapter" data-level="3.4" data-path="week-1.html"><a href="week-1.html#additional-resources"><i class="fa fa-check"></i><b>3.4</b> Additional Resources</a></li>
<li class="chapter" data-level="3.5" data-path="week-1.html"><a href="week-1.html#homework"><i class="fa fa-check"></i><b>3.5</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-3.html"><a href="week-3.html"><i class="fa fa-check"></i><b>4</b> Week 3</a><ul>
<li class="chapter" data-level="4.1" data-path="week-3.html"><a href="week-3.html#week-3-learning-objectives"><i class="fa fa-check"></i><b>4.1</b> Week 3 Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="week-3.html"><a href="week-3.html#organizing-a-data-analysis"><i class="fa fa-check"></i><b>4.2</b> Organizing a data analysis</a><ul>
<li class="chapter" data-level="4.2.1" data-path="week-3.html"><a href="week-3.html#motivation---the-stick"><i class="fa fa-check"></i><b>4.2.1</b> Motivation - the stick</a></li>
<li class="chapter" data-level="4.2.2" data-path="week-3.html"><a href="week-3.html#motivation---the-carrot"><i class="fa fa-check"></i><b>4.2.2</b> Motivation - the carrot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="week-3.html"><a href="week-3.html#project-organization"><i class="fa fa-check"></i><b>4.3</b> Project Organization</a><ul>
<li class="chapter" data-level="4.3.1" data-path="week-3.html"><a href="week-3.html#readme.md"><i class="fa fa-check"></i><b>4.3.1</b> README.md</a></li>
<li class="chapter" data-level="4.3.2" data-path="week-3.html"><a href="week-3.html#gitignore"><i class="fa fa-check"></i><b>4.3.2</b> .gitignore</a></li>
<li class="chapter" data-level="4.3.3" data-path="week-3.html"><a href="week-3.html#data"><i class="fa fa-check"></i><b>4.3.3</b> data/</a></li>
<li class="chapter" data-level="4.3.4" data-path="week-3.html"><a href="week-3.html#code"><i class="fa fa-check"></i><b>4.3.4</b> code/</a></li>
<li class="chapter" data-level="4.3.5" data-path="week-1.html"><a href="week-1.html#figures"><i class="fa fa-check"></i><b>4.3.5</b> figures</a></li>
<li class="chapter" data-level="4.3.6" data-path="week-3.html"><a href="week-3.html#products"><i class="fa fa-check"></i><b>4.3.6</b> products/</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="week-3.html"><a href="week-3.html#file-naming"><i class="fa fa-check"></i><b>4.4</b> File naming</a></li>
<li class="chapter" data-level="4.5" data-path="week-3.html"><a href="week-3.html#absolute-vs.-relative-paths"><i class="fa fa-check"></i><b>4.5</b> Absolute vs. relative paths</a></li>
<li class="chapter" data-level="4.6" data-path="week-3.html"><a href="week-3.html#coding-variables"><i class="fa fa-check"></i><b>4.6</b> Coding Variables</a></li>
<li class="chapter" data-level="4.7" data-path="week-3.html"><a href="week-3.html#project-management-software"><i class="fa fa-check"></i><b>4.7</b> Project management software</a></li>
<li class="chapter" data-level="4.8" data-path="week-3.html"><a href="week-3.html#coding-style"><i class="fa fa-check"></i><b>4.8</b> Coding style</a></li>
<li class="chapter" data-level="4.9" data-path="week-3.html"><a href="week-3.html#chain-of-custody-for-data"><i class="fa fa-check"></i><b>4.9</b> Chain of Custody for Data</a></li>
<li class="chapter" data-level="4.10" data-path="week-3.html"><a href="week-3.html#version-control"><i class="fa fa-check"></i><b>4.10</b> Version Control</a></li>
<li class="chapter" data-level="4.11" data-path="week-1.html"><a href="week-1.html#additional-resources"><i class="fa fa-check"></i><b>4.11</b> Additional Resources</a></li>
<li class="chapter" data-level="4.12" data-path="week-1.html"><a href="week-1.html#homework"><i class="fa fa-check"></i><b>4.12</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-4.html"><a href="week-4.html"><i class="fa fa-check"></i><b>5</b> Week 4</a><ul>
<li class="chapter" data-level="5.1" data-path="week-4.html"><a href="week-4.html#week-4-learning-objectives"><i class="fa fa-check"></i><b>5.1</b> Week 4 Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="week-4.html"><a href="week-4.html#the-optimality-paradox"><i class="fa fa-check"></i><b>5.2</b> The optimality paradox</a></li>
<li class="chapter" data-level="5.3" data-path="week-4.html"><a href="week-4.html#an-example-of-the-art-of-data-science"><i class="fa fa-check"></i><b>5.3</b> An example of the art of data science</a><ul>
<li class="chapter" data-level="5.3.1" data-path="week-4.html"><a href="week-4.html#an-important-subtlety---analyst-decisions-change-the-question"><i class="fa fa-check"></i><b>5.3.1</b> An important subtlety - analyst decisions change the question</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="week-4.html"><a href="week-4.html#early-definitions-of-success"><i class="fa fa-check"></i><b>5.4</b> Early definitions of success</a><ul>
<li class="chapter" data-level="5.4.1" data-path="week-1.html"><a href="week-1.html#reproducibility"><i class="fa fa-check"></i><b>5.4.1</b> Reproducibility</a></li>
<li class="chapter" data-level="5.4.2" data-path="week-4.html"><a href="week-4.html#replicability"><i class="fa fa-check"></i><b>5.4.2</b> Replicability</a></li>
<li class="chapter" data-level="5.4.3" data-path="week-4.html"><a href="week-4.html#false-discovery"><i class="fa fa-check"></i><b>5.4.3</b> False discovery</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="week-4.html"><a href="week-4.html#a-theory-of-data-science-success"><i class="fa fa-check"></i><b>5.5</b> A theory of data science success</a><ul>
<li class="chapter" data-level="5.5.1" data-path="week-4.html"><a href="week-4.html#elements-of-data-science"><i class="fa fa-check"></i><b>5.5.1</b> Elements of Data Science</a></li>
<li class="chapter" data-level="5.5.2" data-path="week-4.html"><a href="week-4.html#principles-of-data-science"><i class="fa fa-check"></i><b>5.5.2</b> Principles of Data Science</a></li>
<li class="chapter" data-level="5.5.3" data-path="week-4.html"><a href="week-4.html#data-matching"><i class="fa fa-check"></i><b>5.5.3</b> Data matching</a></li>
<li class="chapter" data-level="5.5.4" data-path="week-4.html"><a href="week-4.html#exhaustive"><i class="fa fa-check"></i><b>5.5.4</b> Exhaustive</a></li>
<li class="chapter" data-level="5.5.5" data-path="week-4.html"><a href="week-4.html#skeptical"><i class="fa fa-check"></i><b>5.5.5</b> Skeptical</a></li>
<li class="chapter" data-level="5.5.6" data-path="week-4.html"><a href="week-4.html#second-order"><i class="fa fa-check"></i><b>5.5.6</b> Second order</a></li>
<li class="chapter" data-level="5.5.7" data-path="week-4.html"><a href="week-4.html#transparent"><i class="fa fa-check"></i><b>5.5.7</b> Transparent</a></li>
<li class="chapter" data-level="5.5.8" data-path="week-4.html"><a href="week-4.html#reproducible"><i class="fa fa-check"></i><b>5.5.8</b> Reproducible</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="week-4.html"><a href="week-4.html#a-successful-data-analysis"><i class="fa fa-check"></i><b>5.6</b> A successful data analysis</a></li>
<li class="chapter" data-level="5.7" data-path="week-4.html"><a href="week-4.html#constraints-and-expectation-matching"><i class="fa fa-check"></i><b>5.7</b> Constraints and expectation matching</a></li>
<li class="chapter" data-level="5.8" data-path="week-4.html"><a href="week-4.html#what-about-being-correct"><i class="fa fa-check"></i><b>5.8</b> What about being correct?</a></li>
<li class="chapter" data-level="5.9" data-path="week-1.html"><a href="week-1.html#additional-resources"><i class="fa fa-check"></i><b>5.9</b> Additional Resources</a></li>
<li class="chapter" data-level="5.10" data-path="week-1.html"><a href="week-1.html#homework"><i class="fa fa-check"></i><b>5.10</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-5.html"><a href="week-5.html"><i class="fa fa-check"></i><b>6</b> Week 5</a><ul>
<li class="chapter" data-level="6.1" data-path="week-5.html"><a href="week-5.html#week-5-learning-objectives"><i class="fa fa-check"></i><b>6.1</b> Week 5 Learning Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="week-5.html"><a href="week-5.html#skepticism-vs.-discovery"><i class="fa fa-check"></i><b>6.2</b> Skepticism vs. Discovery</a></li>
<li class="chapter" data-level="6.3" data-path="week-1.html"><a href="week-1.html#figures"><i class="fa fa-check"></i><b>6.3</b> Figures</a><ul>
<li class="chapter" data-level="6.3.1" data-path="week-5.html"><a href="week-5.html#be-accurate-and-clear"><i class="fa fa-check"></i><b>6.3.1</b> Be accurate and clear</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="week-5.html"><a href="week-5.html#common-data-analytic-fallacies"><i class="fa fa-check"></i><b>6.4</b> Common data analytic fallacies</a><ul>
<li class="chapter" data-level="6.4.1" data-path="week-5.html"><a href="week-5.html#spurious-correlation"><i class="fa fa-check"></i><b>6.4.1</b> Spurious correlation</a></li>
<li class="chapter" data-level="6.4.2" data-path="week-5.html"><a href="week-5.html#outliers"><i class="fa fa-check"></i><b>6.4.2</b> Outliers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="outliers-1.html"><a href="outliers-1.html"><i class="fa fa-check"></i><b>7</b> Outliers</a><ul>
<li class="chapter" data-level="7.0.1" data-path="outliers-1.html"><a href="outliers-1.html#reversing-cause-and-effect"><i class="fa fa-check"></i><b>7.0.1</b> Reversing Cause and Effect</a></li>
<li class="chapter" data-level="7.0.2" data-path="outliers-1.html"><a href="outliers-1.html#confounders"><i class="fa fa-check"></i><b>7.0.2</b> Confounders</a></li>
<li class="chapter" data-level="7.0.3" data-path="outliers-1.html"><a href="outliers-1.html#simpsons-paradox"><i class="fa fa-check"></i><b>7.0.3</b> Simpson’s Paradox</a></li>
<li class="chapter" data-level="7.1" data-path="week-1.html"><a href="week-1.html#additional-resources"><i class="fa fa-check"></i><b>7.1</b> Additional Resources</a></li>
<li class="chapter" data-level="7.2" data-path="week-1.html"><a href="week-1.html#homework"><i class="fa fa-check"></i><b>7.2</b> Homework</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Data Science 2020</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="outliers-1" class="section level1">
<h1><span class="header-section-number">7</span> Outliers</h1>
<p>Suppose we take measurements from two independent outcomes,
<span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and we standardize the measurements. However,
imagine we make a mistake and forget to standardize
entry 23. We can simulate such data using:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="outliers-1.html#cb15-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb15-2"><a href="outliers-1.html#cb15-2"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb15-3"><a href="outliers-1.html#cb15-3"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">84</span>,<span class="dv">1</span>)</span>
<span id="cb15-4"><a href="outliers-1.html#cb15-4"></a>x[<span class="op">-</span><span class="dv">23</span>] &lt;-<span class="st"> </span><span class="kw">scale</span>(x[<span class="op">-</span><span class="dv">23</span>])</span>
<span id="cb15-5"><a href="outliers-1.html#cb15-5"></a>y[<span class="op">-</span><span class="dv">23</span>] &lt;-<span class="st"> </span><span class="kw">scale</span>(y[<span class="op">-</span><span class="dv">23</span>])</span></code></pre></div>
<p>The data look like this:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="outliers-1.html#cb16-1"></a><span class="kw">tibble</span>(x,y) <span class="op">%&gt;%</span></span>
<span id="cb16-2"><a href="outliers-1.html#cb16-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x,y)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-3"><a href="outliers-1.html#cb16-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="05-week_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Not surprisingly, the correlation is very high:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="outliers-1.html#cb17-1"></a><span class="kw">cor</span>(x,y)</span></code></pre></div>
<pre><code>## [1] 0.9881391</code></pre>
<p>But this is driven by the one outlier. If we remove
this outlier, the correlation is greatly reduced
to almost 0, what it should be:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="outliers-1.html#cb19-1"></a><span class="kw">cor</span>(x[<span class="op">-</span><span class="dv">23</span>], y[<span class="op">-</span><span class="dv">23</span>])</span></code></pre></div>
<pre><code>## [1] -0.001066464</code></pre>
<p>There is an alternative to the sample correlation for
estimating the population correlation that is robust
to outliers. It is called <em>Spearman correlation</em>.</p>
<p>The idea is simple: compute the correlation on the ranks
of the values. Here is a plot of the ranks plotted
against each other:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="outliers-1.html#cb21-1"></a><span class="kw">tibble</span>(x,y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-2"><a href="outliers-1.html#cb21-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">rank</span>(x),<span class="kw">rank</span>(y))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-3"><a href="outliers-1.html#cb21-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="05-week_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The outlier is no longer associated with a very
large value and the correlation comes way down:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="outliers-1.html#cb22-1"></a><span class="kw">cor</span>(<span class="kw">rank</span>(x), <span class="kw">rank</span>(y))</span></code></pre></div>
<pre><code>## [1] 0.06583858</code></pre>
<p>Spearman correlation can also be calculated like this:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="outliers-1.html#cb24-1"></a><span class="kw">cor</span>(x, y, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.06583858</code></pre>
<p>There are also methods for robust fitting of linear models
which you can learn about in, for instance, this book:</p>
<p>Robust Statistics: Edition 2
Peter J. Huber Elvezio M. Ronchetti</p>
<div id="reversing-cause-and-effect" class="section level3">
<h3><span class="header-section-number">7.0.1</span> Reversing Cause and Effect</h3>
<p>Another way association is confused with causation is when
the cause and effect are reversed. An example of this is
claiming that tutoring makes students perform worse because
they test lower than peers that are not tutored. In this
case, the tutoring is not causing the low test scores,
but the other way around.</p>
<p>A form of this claim was actually made it into an op-ed
in the New York Times titled
<a href="https://opinionator.blogs.nytimes.com/2014/04/12/parental-involvement-is-overrated/?rref=opinion&amp;module=ArrowsNav&amp;contentCollection=Opinion&amp;action=keypress&amp;region=FixedLeft&amp;pgtype=Blogs">Parental Involvement Is Overrated</a>.</p>
<p>Consider this quote from the article:</p>
<blockquote>
<p>When we examined whether regular help with homework had a positive impact on children’s academic performance, we were quite startled by what we found. Regardless of a family’s social class, racial or ethnic background, or a child’s grade level, consistent homework help almost never improved test scores or grades… Even more surprising to us was that when parents regularly helped with homework, kids usually performed worse.
A very likely possibility is that the children needing
regular parental help, receive this help because
they don’t perform well in school.</p>
</blockquote>
<p>We can easily construct an example of cause and
effect reversal using the father and son height
data. If we fit the model:</p>
<p><span class="math display">\[X_i = \beta_0 + \beta_1 y_i + \varepsilon_i, i=1, \dots, N\]</span></p>
<p>to the father and son height data, with <span class="math inline">\(X_i\)</span> the
father height and <span class="math inline">\(y_i\)</span> the son height, we do get a
statistically significant result:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="outliers-1.html#cb26-1"></a><span class="kw">library</span>(HistData)</span>
<span id="cb26-2"><a href="outliers-1.html#cb26-2"></a><span class="kw">data</span>(<span class="st">&quot;GaltonFamilies&quot;</span>)</span>
<span id="cb26-3"><a href="outliers-1.html#cb26-3"></a>GaltonFamilies <span class="op">%&gt;%</span></span>
<span id="cb26-4"><a href="outliers-1.html#cb26-4"></a><span class="st">  </span><span class="kw">filter</span>(childNum <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>gender <span class="op">==</span><span class="st"> &quot;male&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb26-5"><a href="outliers-1.html#cb26-5"></a><span class="st">  </span><span class="kw">select</span>(father, childHeight) <span class="op">%&gt;%</span></span>
<span id="cb26-6"><a href="outliers-1.html#cb26-6"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">son =</span> childHeight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-7"><a href="outliers-1.html#cb26-7"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">lm</span>(father <span class="op">~</span><span class="st"> </span>son, <span class="dt">data =</span> .)))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   34.0      4.57        7.44 4.31e-12
## 2 son            0.499    0.0648      7.70 9.47e-13</code></pre>
<p>The model fits the data very well. If we look at the
mathematical formulation of the model above, it could
easily be incorrectly interpreted as to suggest that
the son being tall caused the father to be tall. But
given what we know about genetics and biology, we
know it’s the other way around. The model is technically
correct. The estimates and p-values were obtained
correctly as well. What is wrong here is the interpretation.</p>
</div>
<div id="confounders" class="section level3">
<h3><span class="header-section-number">7.0.2</span> Confounders</h3>
<p>Confounders are perhaps the most common reason that
leads to associations being misinterpreted.</p>
<p>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are correlated, we call <span class="math inline">\(Z\)</span> a <em>confounder</em>
if changes in <span class="math inline">\(Z\)</span> cause changes in both <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>Incorrect interpretation due to confounders is
ubiquitous in the lay press. It is sometimes hard
to detect. Here we present two examples, both
related to gender discrimination.</p>
<div id="case-study-uc-berkeley-admissions" class="section level4">
<h4><span class="header-section-number">7.0.2.1</span> Case Study: UC Berkeley admissions</h4>
<p>Admission data from six U.C. Berkeley majors, from 1973,
showed that more men were being admitted than women:
44% men were admitted compared to 30% women. PJ Bickel,
EA Hammel, and JW O’Connell. Science (1975).</p>
<p>Here are the data:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="outliers-1.html#cb28-1"></a><span class="kw">data</span>(admissions)</span>
<span id="cb28-2"><a href="outliers-1.html#cb28-2"></a>admissions</span></code></pre></div>
<pre><code>##    major gender admitted applicants
## 1      A    men       62        825
## 2      B    men       63        560
## 3      C    men       37        325
## 4      D    men       33        417
## 5      E    men       28        191
## 6      F    men        6        373
## 7      A  women       82        108
## 8      B  women       68         25
## 9      C  women       34        593
## 10     D  women       35        375
## 11     E  women       24        393
## 12     F  women        7        341</code></pre>
<p>We see the percent of men and women that
were accepted was:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="outliers-1.html#cb30-1"></a>admissions <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-2"><a href="outliers-1.html#cb30-2"></a><span class="st">  </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-3"><a href="outliers-1.html#cb30-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">percentage =</span></span>
<span id="cb30-4"><a href="outliers-1.html#cb30-4"></a>            <span class="kw">round</span>(<span class="kw">sum</span>(admitted<span class="op">*</span>applicants)<span class="op">/</span><span class="kw">sum</span>(applicants),<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 2 x 2
##   gender percentage
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 men          44.5
## 2 women        30.3</code></pre>
<p>A statistical test clearly rejects the hypothesis
that gender and admission are independent:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="outliers-1.html#cb33-1"></a>dat &lt;-<span class="st"> </span>admissions <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-2"><a href="outliers-1.html#cb33-2"></a><span class="st">  </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-3"><a href="outliers-1.html#cb33-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">total_admitted =</span> <span class="kw">round</span>(<span class="kw">sum</span>((admitted<span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>applicants)), </span>
<span id="cb33-4"><a href="outliers-1.html#cb33-4"></a>            <span class="dt">not_admitted =</span> <span class="kw">sum</span>(applicants) <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(total_admitted)) <span class="op">%&gt;%</span></span>
<span id="cb33-5"><a href="outliers-1.html#cb33-5"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>gender) </span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="outliers-1.html#cb35-1"></a>dat <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-2"><a href="outliers-1.html#cb35-2"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">chisq.test</span>(.)))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   statistic  p.value parameter method                                           
##       &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;                                            
## 1      91.6 1.06e-21         1 Pearson&#39;s Chi-squared test with Yates&#39; continuit…</code></pre>
<p>But closer inspection shows a paradoxical result. Here
are the percent admissions by major:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="outliers-1.html#cb37-1"></a>admissions <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-2"><a href="outliers-1.html#cb37-2"></a><span class="st">  </span><span class="kw">select</span>(major, gender, admitted) <span class="op">%&gt;%</span></span>
<span id="cb37-3"><a href="outliers-1.html#cb37-3"></a><span class="st">  </span><span class="kw">spread</span>(gender, admitted) <span class="op">%&gt;%</span></span>
<span id="cb37-4"><a href="outliers-1.html#cb37-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">women_minus_men =</span> women <span class="op">-</span><span class="st"> </span>men)</span></code></pre></div>
<pre><code>##   major men women women_minus_men
## 1     A  62    82              20
## 2     B  63    68               5
## 3     C  37    34              -3
## 4     D  33    35               2
## 5     E  28    24              -4
## 6     F   6     7               1</code></pre>
<p>Four out of the six majors favor women. More importantly
all the differences are much smaller than the 14.2
difference that we see when examining the totals.</p>
<p>The paradox is that analyzing the totals suggests a
dependence between admission and gender, but when the
data is grouped by major, this dependence seems to
disappear.</p>
<p>What’s going on? This actually can happen if an
uncounted confounder is driving most of the
variability.</p>
<p>So let’s define three variables:</p>
<ul>
<li><span class="math inline">\(X=1\)</span> for men and <span class="math inline">\(X=0\)</span> for women</li>
<li><span class="math inline">\(Y=1\)</span> for those admitted and <span class="math inline">\(Y=0\)</span> otherwise</li>
<li><span class="math inline">\(Z\)</span> quantifies how selective is the major</li>
</ul>
<p>A gender bias claim would be based on the fact that
<span class="math inline">\(\mbox{Pr}(Y=1 | X = x)\)</span> is higher for <span class="math inline">\(X=1\)</span> then
<span class="math inline">\(X=0\)</span>. But <span class="math inline">\(Z\)</span> is an important confounder to consider.
Clearly <span class="math inline">\(Z\)</span> is associated with <span class="math inline">\(Y\)</span>, as the more
selective a major, the lower <span class="math inline">\(\mbox{Pr}(Y=1 | Z = z)\)</span>.</p>
<p>But is major selectivity <span class="math inline">\(Z\)</span> associated with gender <span class="math inline">\(X\)</span>?</p>
<p>One way to see this is to plot the total percent
admitted to a major versus the percent of women
that made up the applicants:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="outliers-1.html#cb39-1"></a>admissions <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-2"><a href="outliers-1.html#cb39-2"></a><span class="st">  </span><span class="kw">group_by</span>(major) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-3"><a href="outliers-1.html#cb39-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">major_selectivity =</span> <span class="kw">sum</span>(admitted<span class="op">*</span>applicants)<span class="op">/</span><span class="kw">sum</span>(applicants),</span>
<span id="cb39-4"><a href="outliers-1.html#cb39-4"></a>            <span class="dt">percent_women_applicants =</span> <span class="kw">sum</span>(applicants<span class="op">*</span>(gender<span class="op">==</span><span class="st">&quot;women&quot;</span>)<span class="op">/</span><span class="kw">sum</span>(applicants))<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb39-5"><a href="outliers-1.html#cb39-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(major_selectivity, percent_women_applicants, <span class="dt">label =</span> major)) <span class="op">+</span></span>
<span id="cb39-6"><a href="outliers-1.html#cb39-6"></a><span class="st">  </span><span class="kw">geom_text</span>()</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<p><img src="05-week_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>There seems to be an association. The plot suggests that
women were much more likely to apply to the two “hard” majors:
gender and major’s selectivity are confounded. Compare, for
example, major B and major E. Major E is much harder to
enter than major B and over 60% of applicants to major E
were women while less than 10% of the applicants of major
B were women.</p>
</div>
<div id="confounding-explained-graphically" class="section level4">
<h4><span class="header-section-number">7.0.2.2</span> Confounding explained graphically</h4>
<p>The following plot shows the percent of applicants that were
accepted by gender.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="outliers-1.html#cb41-1"></a>admissions <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-2"><a href="outliers-1.html#cb41-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent_admitted =</span> admitted<span class="op">*</span>applicants<span class="op">/</span><span class="kw">sum</span>(applicants)) <span class="op">%&gt;%</span></span>
<span id="cb41-3"><a href="outliers-1.html#cb41-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(gender, <span class="dt">y =</span> percent_admitted, <span class="dt">fill =</span> major)) <span class="op">+</span></span>
<span id="cb41-4"><a href="outliers-1.html#cb41-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;stack&quot;</span>)</span></code></pre></div>
<p><img src="05-week_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>It also breaks down the acceptance rates by major: the size
of the colored bars represents the percent of each major
students were admitted to. This breakdown allows us to
see that the majority of accepted men come from two majors:
A and B. It also lets us see that few women were accepted
to these majors.</p>
<p>What the plot does <strong>not</strong> show us is
the number of applicants for each major.</p>
</div>
<div id="average-after-stratifying" class="section level4">
<h4><span class="header-section-number">7.0.2.3</span> Average after stratifying</h4>
<p>In this plot, we can see that if we condition or stratify
by major, and then look at differences, we control for
the confounder and this effect goes away.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="outliers-1.html#cb42-1"></a>admissions <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-2"><a href="outliers-1.html#cb42-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(major, admitted, <span class="dt">col =</span> gender, </span>
<span id="cb42-3"><a href="outliers-1.html#cb42-3"></a>             <span class="dt">size =</span> applicants)) <span class="op">+</span></span>
<span id="cb42-4"><a href="outliers-1.html#cb42-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Major&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-5"><a href="outliers-1.html#cb42-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Admission percentage by major for each gender&quot;</span>)</span></code></pre></div>
<p><img src="05-week_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Now we see that major by major, there is not
much difference. The size of the dot represents
the number of applicants, and explains the
paradox: we see large red dots and small blue
dots for the easiest majors, A and B.</p>
<p>If we average the difference by major we find that the
percent is actually 3.5% higher for women.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="outliers-1.html#cb43-1"></a>admissions <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-2"><a href="outliers-1.html#cb43-2"></a><span class="st">  </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-3"><a href="outliers-1.html#cb43-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">average =</span> <span class="kw">mean</span>(admitted))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 2 x 2
##   gender average
##   &lt;chr&gt;    &lt;dbl&gt;
## 1 men       38.2
## 2 women     41.7</code></pre>
</div>
</div>
<div id="simpsons-paradox" class="section level3">
<h3><span class="header-section-number">7.0.3</span> Simpson’s Paradox</h3>
<p>The case we have just covered is an example of Simpson’s
Paradox. It is called a paradox because we see the
sign of the correlation of flip when comparing the
entire dataset and specific strata. The following
is an illustrative example. Suppose you have three
variables <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>. Here is a scatterplot of
<span class="math inline">\(Y\)</span> versus <span class="math inline">\(X\)</span>:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="outliers-1.html#cb46-1"></a>N &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb46-2"><a href="outliers-1.html#cb46-2"></a>Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.75</span>,<span class="fl">0.75</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)<span class="op">*</span><span class="fl">1.5</span></span>
<span id="cb46-3"><a href="outliers-1.html#cb46-3"></a>means &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">11</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">5</span>), <span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">7</span>), <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">9</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">11</span>))</span>
<span id="cb46-4"><a href="outliers-1.html#cb46-4"></a>dat &lt;-<span class="st"> </span><span class="kw">lapply</span>(means, <span class="cf">function</span>(mu) </span>
<span id="cb46-5"><a href="outliers-1.html#cb46-5"></a>  MASS<span class="op">::</span><span class="kw">mvrnorm</span>(N, mu, Sigma))</span>
<span id="cb46-6"><a href="outliers-1.html#cb46-6"></a>dat &lt;-<span class="st"> </span><span class="kw">Reduce</span>(rbind, dat)</span>
<span id="cb46-7"><a href="outliers-1.html#cb46-7"></a><span class="kw">colnames</span>(dat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb46-8"><a href="outliers-1.html#cb46-8"></a>dat &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(dat) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-9"><a href="outliers-1.html#cb46-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Z =</span> <span class="kw">as.character</span>(<span class="kw">rep</span>(<span class="kw">seq_along</span>(means), <span class="dt">each =</span> N)))</span></code></pre></div>
<pre><code>## Warning: `tbl_df()` is deprecated as of dplyr 1.0.0.
## Please use `tibble::as_tibble()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="outliers-1.html#cb48-1"></a>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(X,Y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></span>
<span id="cb48-2"><a href="outliers-1.html#cb48-2"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">paste</span>(<span class="st">&quot;correlation = &quot;</span>, <span class="kw">round</span>(<span class="kw">cor</span>(dat<span class="op">$</span>X, dat<span class="op">$</span>Y), <span class="dv">2</span>)))</span></code></pre></div>
<p><img src="05-week_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>You can see that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are negatively correlated.
However, once we stratify by <span class="math inline">\(Z\)</span>, shown in different
colors below, another pattern emerges.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="outliers-1.html#cb49-1"></a>means &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">Reduce</span>(rbind, means)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb49-2"><a href="outliers-1.html#cb49-2"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">x =</span> V1, <span class="dt">y =</span> V2) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb49-3"><a href="outliers-1.html#cb49-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">as.character</span>(<span class="kw">seq_along</span>(means)))</span></code></pre></div>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="outliers-1.html#cb51-1"></a>corrs &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-2"><a href="outliers-1.html#cb51-2"></a><span class="st">  </span><span class="kw">group_by</span>(Z) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-3"><a href="outliers-1.html#cb51-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">cor =</span> <span class="kw">cor</span>(X,Y)) <span class="op">%&gt;%</span></span>
<span id="cb51-4"><a href="outliers-1.html#cb51-4"></a><span class="st">  </span><span class="kw">pull</span>(cor) </span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="outliers-1.html#cb53-1"></a>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(X, Y, <span class="dt">color =</span> Z)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb53-2"><a href="outliers-1.html#cb53-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb53-3"><a href="outliers-1.html#cb53-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">paste</span>(<span class="st">&quot;correlations =&quot;</span>, </span>
<span id="cb53-4"><a href="outliers-1.html#cb53-4"></a>                <span class="kw">paste</span>(<span class="kw">signif</span>(corrs,<span class="dv">2</span>), <span class="dt">collapse=</span><span class="st">&quot; &quot;</span>))) <span class="op">+</span></span>
<span id="cb53-5"><a href="outliers-1.html#cb53-5"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> means<span class="op">$</span>x, <span class="dt">y =</span> means<span class="op">$</span>y, </span>
<span id="cb53-6"><a href="outliers-1.html#cb53-6"></a>           <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Z=&quot;</span>, means<span class="op">$</span>z), <span class="dt">cex =</span> <span class="dv">5</span>)  </span></code></pre></div>
<p><img src="05-week_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>It is really <span class="math inline">\(Z\)</span> that is negatively correlated with <span class="math inline">\(X\)</span>.
If we stratify by <span class="math inline">\(Z\)</span>, the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are actually
positively correlated.</p>
<div id="case-study-research-funding-success" class="section level4">
<h4><span class="header-section-number">7.0.3.1</span> Case Study: Research funding success</h4>
<p>Here we examine a similar case to the UC Berkeley
admissions example, but much more subtle.</p>
<p>A <a href="http://www.pnas.org/content/112/40/12349.abstract">2014 PNAS paper</a>
analyzed success rates from funding agencies
in the Netherlands and concluded that their:</p>
<blockquote>
<p>results reveal gender bias favoring male applicants over female applicants in the prioritization of their “quality of researcher” (but not “quality of proposal”) evaluations and success rates, as well as in the language used in instructional and evaluation materials.
or that gender contributes to personal research
funding success in The Netherlands.</p>
</blockquote>
<p>The main evidence for this conclusion comes down
to a comparison of the percentages. Table S1 in
the paper includes the information we need:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="outliers-1.html#cb54-1"></a><span class="kw">data</span>(<span class="st">&quot;research_funding_rates&quot;</span>)</span>
<span id="cb54-2"><a href="outliers-1.html#cb54-2"></a>research_funding_rates</span></code></pre></div>
<pre><code>##            discipline applications_total applications_men applications_women
## 1   Chemical sciences                122               83                 39
## 2   Physical sciences                174              135                 39
## 3             Physics                 76               67                  9
## 4          Humanities                396              230                166
## 5  Technical sciences                251              189                 62
## 6   Interdisciplinary                183              105                 78
## 7 Earth/life sciences                282              156                126
## 8     Social sciences                834              425                409
## 9    Medical sciences                505              245                260
##   awards_total awards_men awards_women success_rates_total success_rates_men
## 1           32         22           10                26.2              26.5
## 2           35         26            9                20.1              19.3
## 3           20         18            2                26.3              26.9
## 4           65         33           32                16.4              14.3
## 5           43         30           13                17.1              15.9
## 6           29         12           17                15.8              11.4
## 7           56         38           18                19.9              24.4
## 8          112         65           47                13.4              15.3
## 9           75         46           29                14.9              18.8
##   success_rates_women
## 1                25.6
## 2                23.1
## 3                22.2
## 4                19.3
## 5                21.0
## 6                21.8
## 7                14.3
## 8                11.5
## 9                11.2</code></pre>
<p>We can construct the two-by-two table used for the conclusion above:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="outliers-1.html#cb56-1"></a>two_by_two &lt;-<span class="st"> </span>research_funding_rates <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb56-2"><a href="outliers-1.html#cb56-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>discipline) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb56-3"><a href="outliers-1.html#cb56-3"></a><span class="st">  </span><span class="kw">summarize_all</span>(sum) <span class="op">%&gt;%</span></span>
<span id="cb56-4"><a href="outliers-1.html#cb56-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">yes_men =</span> awards_men, </span>
<span id="cb56-5"><a href="outliers-1.html#cb56-5"></a>            <span class="dt">no_men =</span> applications_men <span class="op">-</span><span class="st"> </span>awards_men, </span>
<span id="cb56-6"><a href="outliers-1.html#cb56-6"></a>            <span class="dt">yes_women =</span> awards_women, </span>
<span id="cb56-7"><a href="outliers-1.html#cb56-7"></a>            <span class="dt">no_women =</span> applications_women <span class="op">-</span><span class="st"> </span>awards_women) <span class="op">%&gt;%</span></span>
<span id="cb56-8"><a href="outliers-1.html#cb56-8"></a><span class="st">  </span>gather <span class="op">%&gt;%</span></span>
<span id="cb56-9"><a href="outliers-1.html#cb56-9"></a><span class="st">  </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;awarded&quot;</span>, <span class="st">&quot;gender&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb56-10"><a href="outliers-1.html#cb56-10"></a><span class="st">  </span><span class="kw">spread</span>(gender, value)</span>
<span id="cb56-11"><a href="outliers-1.html#cb56-11"></a>two_by_two</span></code></pre></div>
<pre><code>##   awarded  men women
## 1      no 1345  1011
## 2     yes  290   177</code></pre>
<p>Compute the difference in percentage:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="outliers-1.html#cb58-1"></a>two_by_two <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-2"><a href="outliers-1.html#cb58-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">men =</span> <span class="kw">round</span>(men<span class="op">/</span><span class="kw">sum</span>(men)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb58-3"><a href="outliers-1.html#cb58-3"></a>         <span class="dt">women =</span> <span class="kw">round</span>(women<span class="op">/</span><span class="kw">sum</span>(women)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-4"><a href="outliers-1.html#cb58-4"></a><span class="st">  </span><span class="kw">filter</span>(awarded <span class="op">==</span><span class="st"> &quot;yes&quot;</span>)</span></code></pre></div>
<pre><code>##   awarded  men women
## 1     yes 17.7  14.9</code></pre>
<p><strong>Note</strong>: It’s lower for women, and find
that it is almost statistically significant
at the <span class="math inline">\(\alpha=0.05\)</span> level:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="outliers-1.html#cb60-1"></a>two_by_two <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-2"><a href="outliers-1.html#cb60-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>awarded) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-3"><a href="outliers-1.html#cb60-3"></a><span class="st">  </span><span class="kw">chisq.test</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-4"><a href="outliers-1.html#cb60-4"></a><span class="st">  </span>tidy</span></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   statistic p.value parameter method                                            
##       &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;                                             
## 1      3.81  0.0509         1 Pearson&#39;s Chi-squared test with Yates&#39; continuity…</code></pre>
<p>So there appears to be some evidence
of an association. But can we infer causation
here? Is gender bias causing this observed
difference?</p>
<p><a href="http://www.pnas.org/content/112/51/E7036.extract">A response</a>
was published a few months later titled <em>No evidence that gender contributes to personal research funding success in The Netherlands: A reaction to Van der Lee and Ellemers</em> which concluded:</p>
<blockquote>
<p>However, the overall gender effect borders on statistical significance, despite the large sample. Moreover, their conclusion could be a prime example of Simpson’s paradox; if a higher percentage of women apply for grants in more competitive scientific disciplines (i.e., with low application success rates for both men and women), then an analysis across all disciplines could incorrectly show “evidence” of gender inequality.
In the UC Berkeley admissions example, the overall
differences were explained by difference across
disciplines. We use the same approach on the research
funding data and look at comparisons by discipline:</p>
</blockquote>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="outliers-1.html#cb62-1"></a>dat &lt;-<span class="st"> </span>research_funding_rates <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb62-2"><a href="outliers-1.html#cb62-2"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">success_total =</span> success_rates_total,</span>
<span id="cb62-3"><a href="outliers-1.html#cb62-3"></a>         <span class="dt">success_men =</span> success_rates_men,</span>
<span id="cb62-4"><a href="outliers-1.html#cb62-4"></a>         <span class="dt">success_women =</span> success_rates_women) <span class="op">%&gt;%</span></span>
<span id="cb62-5"><a href="outliers-1.html#cb62-5"></a><span class="st">  </span><span class="kw">gather</span>(key, value, <span class="op">-</span>discipline) <span class="op">%&gt;%</span></span>
<span id="cb62-6"><a href="outliers-1.html#cb62-6"></a><span class="st">  </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;gender&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb62-7"><a href="outliers-1.html#cb62-7"></a><span class="st">  </span><span class="kw">spread</span>(type, value) <span class="op">%&gt;%</span></span>
<span id="cb62-8"><a href="outliers-1.html#cb62-8"></a><span class="st">  </span><span class="kw">filter</span>(gender <span class="op">!=</span><span class="st"> &quot;total&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb62-9"><a href="outliers-1.html#cb62-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">discipline =</span> <span class="kw">reorder</span>(discipline, applications, sum))</span>
<span id="cb62-10"><a href="outliers-1.html#cb62-10"></a>dat <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb62-11"><a href="outliers-1.html#cb62-11"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(discipline, success, <span class="dt">size =</span> applications, <span class="dt">color =</span> gender)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb62-12"><a href="outliers-1.html#cb62-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb62-13"><a href="outliers-1.html#cb62-13"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="05-week_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>Here we see that some fields favor men and other women.
We see that the two fields with the largest difference
favoring men, are also the fields with the most applications.
However, are any of these differences statistically
significant?</p>
<p>Keep in mind that even when there is no bias,
we will see differences due to random variability in the
review process as well as random variability across candidates.
If we perform a Fisher test in each discipline, we see that
most differences result in p-values larger than <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="outliers-1.html#cb63-1"></a>do_fisher_test &lt;-<span class="st"> </span><span class="cf">function</span>(m, x, n, y){</span>
<span id="cb63-2"><a href="outliers-1.html#cb63-2"></a>  tab &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">men =</span> <span class="kw">c</span>(x, m<span class="op">-</span>x), <span class="dt">women =</span> <span class="kw">c</span>(y, n<span class="op">-</span>y))</span>
<span id="cb63-3"><a href="outliers-1.html#cb63-3"></a>  <span class="kw">tidy</span>(<span class="kw">fisher.test</span>(tab)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb63-4"><a href="outliers-1.html#cb63-4"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">odds =</span> estimate) <span class="op">%&gt;%</span></span>
<span id="cb63-5"><a href="outliers-1.html#cb63-5"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">difference =</span> y<span class="op">/</span>n <span class="op">-</span><span class="st"> </span>x<span class="op">/</span>m)</span>
<span id="cb63-6"><a href="outliers-1.html#cb63-6"></a>}</span>
<span id="cb63-7"><a href="outliers-1.html#cb63-7"></a>res &lt;-<span class="st"> </span>research_funding_rates <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb63-8"><a href="outliers-1.html#cb63-8"></a><span class="st">  </span><span class="kw">group_by</span>(discipline) <span class="op">%&gt;%</span></span>
<span id="cb63-9"><a href="outliers-1.html#cb63-9"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">do_fisher_test</span>(.<span class="op">$</span>applications_men, .<span class="op">$</span>awards_men, </span>
<span id="cb63-10"><a href="outliers-1.html#cb63-10"></a>                    .<span class="op">$</span>applications_women, .<span class="op">$</span>awards_women)) <span class="op">%&gt;%</span></span>
<span id="cb63-11"><a href="outliers-1.html#cb63-11"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb63-12"><a href="outliers-1.html#cb63-12"></a><span class="st">  </span><span class="kw">select</span>(discipline, difference, p.value) <span class="op">%&gt;%</span></span>
<span id="cb63-13"><a href="outliers-1.html#cb63-13"></a><span class="st">  </span><span class="kw">arrange</span>(difference)</span>
<span id="cb63-14"><a href="outliers-1.html#cb63-14"></a>res </span></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   discipline          difference p.value
##   &lt;chr&gt;                    &lt;dbl&gt;   &lt;dbl&gt;
## 1 Earth/life sciences   -0.101    0.0367
## 2 Medical sciences      -0.0762   0.0175
## 3 Physics               -0.0464   1.00  
## 4 Social sciences       -0.0380   0.127 
## 5 Chemical sciences     -0.00865  1     
## 6 Physical sciences      0.0382   0.651 
## 7 Humanities             0.0493   0.217 
## 8 Technical sciences     0.0509   0.437 
## 9 Interdisciplinary      0.104    0.0671</code></pre>
<p>We see that for Earth/Life Sciences, there is a difference
of 10% favoring men and this has a p-value of 0.04. But
is this a spurious correlation? We performed 9 tests.
Reporting only the one case with a p-value less than
0.05 would be cherry picking.</p>
<p>The overall average of the difference is only -0.3%,
which is much smaller than the standard error:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="outliers-1.html#cb65-1"></a>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">overall_avg =</span> <span class="kw">mean</span>(difference), </span>
<span id="cb65-2"><a href="outliers-1.html#cb65-2"></a>                  <span class="dt">se =</span> <span class="kw">sd</span>(difference)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">n</span>()))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   overall_avg     se
##         &lt;dbl&gt;  &lt;dbl&gt;
## 1    -0.00311 0.0226</code></pre>
<p>Furthermore, note that the differences appear
to follow a normal distribution:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="outliers-1.html#cb67-1"></a>res <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb67-2"><a href="outliers-1.html#cb67-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">scale</span>(difference))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb67-3"><a href="outliers-1.html#cb67-3"></a><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_abline</span>()</span></code></pre></div>
<p><img src="05-week_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>which suggests the possibility that the observed
differences are just due to chance.</p>
</div>
</div>
<div id="additional-resources" class="section level2">
<h2><span class="header-section-number">7.1</span> Additional Resources</h2>
<div class="resources">

</div>
</div>
<div id="homework" class="section level2">
<h2><span class="header-section-number">7.2</span> Homework</h2>
<div class="homework">
<ul>
<li><strong>Template Repo</strong>: <a href="https://github.com/advdatasci/homework5" class="uri">https://github.com/advdatasci/homework5</a></li>
<li><strong>Repo Name</strong>: homework5-ind-yourgithubusername</li>
<li><strong>Pull Date</strong>: 2020/10/05 9:00AM Baltimore Time</li>
</ul>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-5.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ads2020.pdf", "ads2020.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
